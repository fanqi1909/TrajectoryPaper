\section{Response to Review 2}

\textbf{2.1} \emph{The GCMP generalization is not particularly novel. Putting a maximum gap size
on consecutive segments is well-known
in sequence mining published more than
10 years ago.}

\textbf{Response:} We admit that the gap parameter
is also used in mining Gap-restricted Sequential Patterns (GSP). 
However, our work is the first to introduce the gap concept 
in co-movement mining to resolve the
loose-connection anomaly (as shown in Figure 2).  
Moreover, we also provide
a unified model to capture existing pattern models which 
is also not proposed before.
%
%The novelty of our modeling
%is bi-folded. First, we unify existing co-movement patterns in
%a GCMP model. Second, we use the gap-constraint to avoid
%the loose-connection anomaly (as shown in Figure 2) which 
%is suffered by existing patterns.

%
%We admit that the gap parameter is also used in
%mining Gap-restricted Sequential Patterns (GSP). 
%However, the novelty of this paper lies
%on the one-stop solution of mining co-movement patterns.
%In modeling, we provide the generalize co-movement pattern to
%alleviate the troubles
%is not merely on introducing the gap-constraint.
%Instead, we provide a one-stop solution for mining co-movement patterns. With
%our 
%
%However, the novelty
%of this paper is not merely on introducing the gap-constraint to the generalized
%co-movement pattern. 
%Instead, we provide a one-stop solution (both in modeling and in technical)
%for mining various co-movement patterns with flexible constraints.
%
%This solution not only alleviate the cumbersome for designing each
%individual patterns, but also 
%
% With
%these constraints, users are able to define a more accurate pattern
%which are free from the anomalies (e.g., loss-connection anomaly in Figure 2).

Besides, GSP and GCMP are designed with different goals. Thus it is infeasible
to model GCMP using GSP. 
In particular, the goal of GSP 
is to find the frequently occurred subsequences which conform to the gap constraint.
This definition ignores the relationships among the involved objects. 
As a consequence, the mined GSP results cannot guarantee the spatial closeness of the involved
objects, which contradicts with \emph{closeness} requirement of GCMP (Section 3 Definition 2). 
For example, in the sample trajectory database in Figure 1, 
the most frequent temporal sequence for GSP is
$(1,2,3,4,5,6)$ because it appears in all trajectories. 
However, the involved objects $\{o_1,o_2,o_3,o_4,o_5,o_6\}$ are NOT all
spatially close at any of the timestamps thus these objects do not form a proper GCMP.
We summarize this difference in Section 2.5.

%
%
%When counting the occurrence of a subsequence, the object
%which the subsequence belongs to does not matter. This allows an object
%to contribute multiple times for a subsequence's occurrence (e.g., in ``$o_1:ABCDABC$", $o_1$
%contributes twice for the subsequence $ABC$)
%
%As a result, GSP may double count an object if the object's sequence 
%has two identical subsequence.
%
%the involved objects may be neither
% distinct nor close.
%In contrast, GCMP imposes requirements on both the spatial closeness 
%of objects and the number of distinct objects.
%Due to the unawareness of objects, techniques that are used in GSP 
%cannot be directly applied on GCMP. We summarize this difference
%in Section 2.5.


\textbf{2.2} \emph{In fact, I have doubts about formulating the GCMP patterns as proposed. Are
we really interested in all sets of movements beyond a cardinality of size $M$? 
Take the Taxi dataset as an example. Let say that there are lots of taxis going
from the airport to downtown. Let say that there are 1000 such taxis. For a
given $M$, are we interested in ${1000 \choose M}$ answers? 
So this speaks to the problem of picking $M$. If $M$ is 500, what is ${1000 \choose M}$? In fact, even if the
system gives the single answer of ${1000\choose 1000}$,
I am not sure I am
interested in this pattern as I already know that there are many taxis going from
the airport to downtown. What I think I am really interested in are GCMP that
are ``anomalous'', which is much harder to define.}

\textbf{Response:} We appreciate the reviewer's concerns on the 
size of the output. 
In fact, both TRPM and SPARE
have considered compressing the output by only discovering 
the patterns with larger object set. 
Particularly,  in the Line Sweeping Mining (Algorithm 1) of TRPM, whenever
a pattern $c$ becomes valid, it is directly outputted (Lines 14-16). This
prohibits outputting $c$'s subset. Similarly, in the Apriori Enumerator (Algorithm 3)
of SPARE, a pattern $c$ is outputted if none of its supersets could become a valid pattern (Line 12-14).
This ensures the output $c$ is not a subset of some pattern.
These mechanisms effectively condense the output by subsuming smaller
patterns using their supersets.
% Nevertheless, these mechanisms are able to preserve ALL valid patterns.
Linking to the Taxi example, if the ground truth contains 1000 taxis travel
together, then both TRPM and SPARE tend to output the single pattern.
In addition, real detection of ``anomalous'' co-moment pattern needs to 
impose stringent constraints via $M,K,L,G$. This would further reduces 
the size of the output.
%On the other hand, in reality, if users wish to detect ``anomalous'' patterns,
%the parameters $M,K,L,G$ will be set to be very stringent. This reduces
%the size of potential outputs. For example, when detecting the Taxi's movements
%without ground truth of 1000 taxis, an input could be $M = 100$, $K=50$ min, $L=30$ min,
%$G = 2$ min. Then, there would be very less patterns satisfying these constraints.
% and the meaningfulness of the output. 
%In terms of the output size, 
%we certainly do not need to output every pattern.
%In fact, both TRPM and SPARE algorithms tend to only output
%the patterns with larger object size. That is to say, for
%the Taxi example, the pattern containing all the 1000 taxis will
%be outputted. To see this, in Algorithm 1, TRPM effectively 
%starts with a temporally invalid pattern and continue
%to shrink its object set until it is temporally valid. Then, the result
%is the ``largest'' valid pattern for these object. Similarly,
%in Algorithm 3, SPARE effectively starts with a temporally valid
%pattern with small object set. Then SPARE continues to grow
%the object set until its temporal dimension is about to be non-decomposable (Definition 5).
%Therefore both TRPM and SPARE tends to find the ``largest'' valid
%patterns.
%
%In terms of the meaningfulness, we believe that all patterns that conformed
%to the parameters need to be outputted. 
%This is because the parameters
%
%
%We see two questions derived from this concern. First, do we need
%to output all ${1000 \choose M}$ patterns if $1000$ taxis form a true GCMP
%pattern? Our answer to this question is no. Therefore, the nature of both
%of our TRPM and SPARE algorithms tend to only output the patterns containing 
%larger sets of objects. To see this, in Algorithm 1, TRPM starts with an temporal invalid
%pattern and continues to shrink its object set while growing its temporal dimension.
%TRPM stops as soon as the object become valid. In an inverse way, in Algorithm 3, 
%SPARE starts with a pattern with small objects and continues to grow its object set
%while reducing its temporal dimension. SPARE stops as soon as the pattern is about
%to be temporally invalid. Therefore, both TRPM and SPARE would prefer to output
%larger pattern.
%
%
%%
%%We agree with the reviewer that if no other parameters are given, the maximum number
%%of patterns discovered could be as large as ${ \mathbb{O} \choose M}$, which may
%%be less interesting to users.
%However, such a case rarely occurs due to two reasons. First,
%in real trajectory mining, parameter $M$
%is associated with temporal parameters $K,L,G$ and they jointly prune many false
%patterns. Second, the nature of our solutions prefer 
%a larger pattern when possible~\footnote{TRPM shrinks an invalid larger pattern until it is valid. SPARE grows a valid smaller pattern until it is about to be invalid. Therefore both algorithms tend to find larger patterns.}.
%For example, if $(o_1,o_2,o_3)$ is 
%a pattern and $M = 2$, 
%then both TRPM and SPARE only output $(o_1,o_2,o_3)$ but not
%any of its subsets. This effectively compresses smaller patterns.
%
%In addition, when the temporal parameters $K,L,G$ are given,
%a larger $M$ actually decreases the number of resulted patterns. 
%This is because there are less patterns having more than $M$ objects. 
%As shown in Figures 7 (a)(g)(m), a larger $M$ actually reduces the running time of both TRPM and SPARE.


\textbf{2.3} \emph{Regarding the second weak points, one line of related work is the superimposition
of constraints on spatiotemporal mining. An example is a road network. In other words, given a road network, the network imposes constraints on GCMP.}

\textbf{Response:} We understand that spatiotemporal mining with 
domain-specific constraints may look similar to GCMP.
However, we are unaware of existing works on the same GCMP model
 with domain-specific constraints.

Generally, patterns defined with domain-specific constraints are hard to be generalized.
This is because constraints available in one domain (e.g., road direction in road networks)
are often not available in other domains (e.g., no road directions available for visitor movements in a shopping mall). Nevertheless,
when deploying on a specific domain, our GCMP solutions are amendable to
incorporate more domain-specific constraints (i.e., rewrite the $\mathtt{sim}$ operation in Algorithm 3). 
We summarize the discussion in Section 2.3.

%often rely on the specific knowledge in that domain (e.g.,
%directions in road networks and maximum speed of traffic), which
%are hard to be generalized. In contrast, GCMP's constraints
%are on spatial (i.e., closeness) and temporal (e.g., max gap and min duration), 
%which can be generalized for all trajectories. For example,
%mining techniques on road networks fails to find patterns
%in  
%
%However, existing techniques on spatiotemporal mining with domain-specific  
%
%
%those techniques often heavily utilize the domain knowledge (such as
%directions in road networks) which are nontrivial to be generalized.
%Differently, since our GCMP model and technical solutions
%do not leverage the domain knowledge, we can support
%pattern discovery in broader scenarios such as user check-in histories in social networks, visitor movements in a building and 
%passenger flows in a city. 
