\appendix
\section{Proofs of Theorems}
%\subsection{Proof of Theorem~\ref{THM:RP_ETA}} 
%\label{appx:proof-rp-eta}
%\begin{proof}
%We compute $\eta$ by analyzing $\range(\rho_{G,L,K}(\cdot))$.
%In the following, when no ambiguity, we use $\rho(T)$ to represent
%$\rho_{G,L,K}(T)$. For any sequence $T$, its $\rho(T)$ can
%be viewed as interleaving segments and gaps. 
%We may view $\rho(T)$ as $l_1,g_1,\ldots, l_{n-1}, g_{n-1}, l_n$, where $l_i$ is a
%segment and $g_i$ is a gap. For simplicity, we use $l_i$ and $g_i$ directly as their sizes.
%Then the
%range of $\rho(T)$ is $\Sigma_{i=1}^{i=n} l_i + \Sigma_{i=1}^{i=n-1} g_i$. 
%Since $\rho(T)$ is valid, the following constraints holds: 
%(1) $\Sigma_{i=1}^{i=n} l_i \geq K$; (2) $\forall l_i$, $l_i \geq L$;
%(3) $\forall g_i$, $g_i \leq G-1$. Based on constraint (1) and (2), 
%$n \leq \lceil \frac{K}{L}\rceil$. 
%This indicates that $\Sigma_{i=1}^{i=n-1} g_i \leq (\lceil \frac{K}{L}\rceil -1 ) (G-1)$.
%If $l_n > L$ and $\Sigma_{i=1}^{i=n} l_i > K$, we can reduce the range of $\rho(T)$
%by reducing $l_n$. If $\Sigma_{i=1}^{i=n} l_i - K < l_n - L$ 
%then, $\Sigma_{i=1}^{i=n} l_i - K$ can be reduced to $K$. In this case, the maximum range of $\rho(T)$ is 
%$\leq K +(\lceil \frac{K}{L}\rceil -1 ) (G-1)$.
%Otherwise, we can reduce $l_n$ to be $L$. When $l_n = L$, 
%since we wish $\rho(T)$ to be minimum, it indicates $\Sigma_{i=1}^{i=n} l_i \leq K-1$.
%Therefore $\Sigma_{i=1}^{i=n} l_i \leq K-1+L$. In this case,
%the maximum range of  $\rho(T)$ is $K-1+L +(\lceil \frac{K}{L}\rceil -1 ) (G-1)$.
%Taking maximum, the maximal possible $\rho(T)$ for all $T$s is thus $K-1+L +(\lceil \frac{K}{L}\rceil -1 ) (G-1)$. This proves the first half of the theorem.
%
%For the second half of theorem, we prove by construction. Given $G,L,K$, let $\eta^*$
%be the optimal value. Then consider the sequence $T$ generated 
%by replicate the following pattern: a $L$-segment followed by $G$-gap. The replication
%stops when $|T|\geq K$. Apparently $T$ is valid wrt. $G,L,K$.
%It is easy to see that the minimum $\range(\rho(T))$ 
%is $(\lceil \frac{K}{L}\rceil -1 ) (G-1) + K$. Since $\eta^*$ is optimal,
%$\eta^* \geq \range(\rho(T)) = (\lceil \frac{K}{L}\rceil -1 ) (G-1) + K$. Recall $\eta =(\lceil \frac{K}{L}\rceil -1 ) (G-1) + K +L-1$, this implies that $\eta \leq \eta^* + L - 1$. 
%\end{proof}
%\subsection{Proof of Theorem~\ref{THM:RP_ETA}}
%\begin{proof}
%Let $T'$ be the \emph{shortest} valid subsequence (wrt. $K,L,G$) 
%of a valid sequence $T$. Let $\eta$ be the upper bound for all $T'$s among 
%all possible valid sequence. It is easy to see that, under such a setting,
%any valid sequence would be captured by one of the partitions in temporal
%replication. This proves the completeness. Now, we compute the minimum value
%of $\eta$ as follows:
%any $T'$ can be viewed as $n$ consecutive segments with sizes $l_1,..,l_n$
%and $n-1$ gaps with sizes $g_1,...,g_{n-1}$. Since $\eta$ is the upper bond among all $T'$s, $\eta$ can be formulated 
%as follows:
%\begin{equation}
%\eta = \max_{n,l_i,g_i} \{ \Sigma_{i=1}^{i=n} l_i + \Sigma_{i=1}^{i=n-1} g_i \}
%\end{equation}
%With the following constraints: (1)$\forall l_i, L \leq l_i \leq K-1$;(2)
%$\forall g_i, 1 \leq g_i \leq G$; (3) $\Sigma_{i=1}^{i=n} l_i \geq K$ and
%(4) $\Sigma_{i=1}^{i=n-1}l_i  \leq K-1$. The constraint (1)(2)(3) due to the 
%validity of $T'$ and the constraint (4) is because of the minimum size of $T'$.
%Observe that, constraints (1)-(4) form a convex polygon and $\eta$ is monotone
%increasing wrt. $n,l_i,g_i$, the maximum value of $\eta$ is thus taken at the boundaries. Further
%observe that $n \in [2, \lceil \frac{K}{L} \rceil]$ and $K \geq 1$, these
%conditions naturally derive
%$\eta = (\lceil \frac{K}{L} \rceil -1)*G+2K -2$.
%%valid pattern $P$, let $T'$ be the subsequence of $P.T$ which conforms to $K,L,G$ 
%%with the smallest length. Note that there could be many qualified $T'$s. 
%%Let the $i^{th}$ local-consecutive segment of $T'$ be $l_i$ and 
%%let the $i^{th}$ gap of $T'$ be $g_i$. Then, the size of $T'$ can 
%%be written as $\Sigma_i (l_i + g_i)$.  Since $T'$ conforms to $K,L,G$, 
%%then $2K \geq \Sigma_i (l_i) \geq K$, $l_i \geq L$, $g_i \leq G$. 
%%It follows: $\Sigma_i(l_i+g_i) \leq (\lceil \frac{K}{L} \rceil -1) *G+2K$. 
%%If every partition is of at least such a size, then $T'$ must be
%%captured by at least one of the partition. Thus, the pattern $P$ would 
%%be valid in that partition. This proves the completeness.
%\end{proof}

%\subsection{Proof of Theorem~\ref{THM:SPM_CORRECT} and Lemma~\ref{LEM:SPM_CORRECT}}


\subsection{Proof of Theorem~\ref{THM:SPM_LB} and~\ref{THM:SPM_LB_INC}}
\label{apx:thm2proof}
\begin{proof}
We formalize optimization of $\Gamma$ using a linear algebra model as follows:  
Let $G_A$ be an aggregate graph, with a $n \times n$ adjacent matrix $J$.
A vertex order is in fact a permutation of $J$. Therefore,
the adjacent matrices of any reordered graphs can be represented as $PJP^T$
where $P \in \mathbb{P}$ is a 
\emph{permutation matrix}~\footnote{an identity matrix with rows shuffled} with dimension $n$.
Since in star partition, we assign each edge $e(i,j)$ in $G_A$ to the lower vertex, 
then the matrix $B=\triu(PJP^T)$~\footnote{\text{triu} is the upper triangle part of a matrix}
represents the assignment matrix wrt. $P$ (i.e., $b_{i,j} = 1$ if vertex $j$ is in star $Sr_i$).
Let vector $\vec{b}$ be the \textit{one}\footnote{every element in $\vec{b}$ is $1$} 
vector of size $n$. Let $\vec{c} = B\vec{b}$, then each $c_i$ 
denotes the number of edges in star $Sr_i$. Thus, $\Gamma$ can be represented
as the infinity norm of $B\vec{b}$. Let $\Gamma^*$ be the minimum $\Gamma$ among all vertex orders. 
$\Gamma^*$ can then be formulated as follows:
\begin{equation}
\Gamma^* = \min_{P \in \mathbb{P}}{||B\vec{b}||_\infty} \text{ ,where } ||B\vec{b}||_\infty = \max_{1\leq j \leq n}(c_j)
\end{equation}

Let $B*$ be the assignment matrix wrt the optimal vertex order.
Since we have a star for each object, by the degree-sum formula and pigeon-hole theorem, 
$\Gamma^*=||B^*\vec{b}||_\infty \geq d/2$.
Next, given a numbering $P$, let $e_{i,j}$ be an entry in $PAP^T$. Since 
edges in graph $G$ are independent, then $e_{i,j}$s are independent. Moreover,
let $d_i$ denote the degree of vertex $i$, 
then $E[d_i]=E[\Sigma_{1\leq j \leq n}e_{i,j}]=d$. This is because renumbering the
vertexes does not affect the average degree.
Since $B=\text{triu}(PAP^T)$, entries in $B$ can be written as :
\begin{equation*}
b_{i,j} = \begin{cases}
			e_{i,j}, i>j \\
			0, otherwise
		  \end{cases}  
\end{equation*}
There are two observations made. First, since $e_{i,j}$s are independent,
$b_{i,j}$s are independent. Second, since $i>j$ and $e_{i,j}$s are independent. 
$E[b_{i,j}] = E[e_{i,j}]E[i>j]= E[e_{i,j}]/2$.

By definition, $c_i = \Sigma_{1\leq j \leq n} b_{i,j}$, 
is a sum of $n$ independent 0-1 variables. Taking expectation on both sides, 
we get: $E[c_i] = E[\Sigma_{1\leq j \leq n} b_{i,j}]=E[\Sigma_{1\leq j \leq n} e_{i,j}]/2 = d/2$.
 Let $\mu =E[c_i] = d/2$, 
$t = \sqrt{n\log n}$, by Hoeffding's Inequality, the following holds:
\begin{equation*}
\begin{split}
	Pr(c_i \geq \mu + t) 
						&\leq \exp(\frac{-2t^2}{n}) \\
						&= \exp(-2\log n) = n^{-2}
\end{split}
\end{equation*}

The first step is due to the fact that all $b_{i,j}$ are bounded in the range of [0,1]. 
Next, since the event $(\max_{1 \leq j \leq n}(c_j) \geq \mu + t)$ can be viewed as
$\cup_{c_i} (c_i \geq \mu + t )$, by Union Bound, we achieve the following:
\begin{equation*}
\begin{split}
	Pr(\Gamma \geq \mu + t) &=Pr(\max_{1\leq j \leq n}(c_j) \geq \mu + t)  \\
		& = Pr(\cup_{c_i} (c_i \geq \mu + t )) \\
		&\leq \Sigma_{1 \leq i \leq n} Pr(c_i \geq \mu + t) \\
		& = n^{-1} = 1/n
\end{split}
\end{equation*}
Substitute back $t$ and $\mu$, we achieve the following concise form:
\begin{equation*}
	Pr(\Gamma \geq (d/2 + \sqrt{n\log n})) \leq 1/n
\end{equation*}
This indicates that, the probability of $(\Gamma-d/2)$ being less than or equal to $ O(\sqrt{n\log n})$ is $(1-1/n)$. 
With the fact that $\Gamma^* \geq d/2$, we conclude that
with probability greater than $(1-1/n)$, 
the difference between $\Gamma$ and $\Gamma^*$ is less than $O(\sqrt{n\log n})$.
When the aggregated graph is \emph{dense} (i.e., $d\geq \sqrt{12 \log n}$), we may use
the Chernoff Bound instead of Hoeffding's Inequality to derive a tighter bound of 
$O(\sqrt{\log n}) $ with the similar reasoning.
\end{proof}

%\subsection{Proof of Theorem~\ref{THM:SPM_TM}}
%\begin{proof}
%Let $P_1$, $P_2$ be two candidates with $P_1.O \subseteq P_2.O$. It is easy to see that $P_1.T \supseteq P_2.T$.
%Suppose $P_1.T$ cannot be simplified to a candidate sequence. Then
%by proof of contradiction, any subset of $P_1.T$ cannot
%be simplified. It follows that $P_2.T$ cannot be simplified to a candidate sequence. 
%In summary, if $P_1.T$ cannot be simplified, $P_2$ can be pruned. 
%\end{proof}

\subsection{Proof of Theorem~\ref{THM:SPM_CORRECT}}
\label{apx:spm_correct}
\begin{proof}
For soundness, let $P$ be a pattern enumerated by SPARE. Since the enumerate algorithm only reduces the time sequences, for any two objects $o_1, o_2 \in P.O$, the edge $e(o_1,o_2)$ is a superset of $P.T$. By the definition of star, $\forall t \in T, C_t(o_1) = C_t(o_2)$. As $T$ is a valid sequence, by the definition of GCMP, $P$ is a true pattern.
For completeness, let $P$ is a true pattern. Let $s$ be the object with smallest ID in $P.O$. We prove that $P$ must be output by Algorithm~\ref{algo:apriori_mining} with input $Sr_s$. 
First, based on the definition of star, every object in $P.O$ appears in $Sr_s$. Since $P.T$ is decomposable, then $\forall O' \subseteq O$, the time sequence of $O'$ is a super set of a decomposable sequence. This indicates that $O'$ would not be eliminated by any $\mathtt{sim}$ operations in Algorithm~\ref{algo:apriori_mining}.  Next, we prove at every iteration \emph{level} $\leq |P.O|$, $P.O \subset O_u$, where $O_u$ is the forward closure. We prove by induction. When $level$ = 2, it obviously holds. If $P.O \subset O_u$ at \emph{level=$i$}, then any subset of $P.O$ with size $i$ are in the candidate set. In \emph{level} $i+1$, these subsets are able to grow to a bigger subset (in last iteration, they grow to $P.O$). This suggests that no subsets are removed by Lines~\ref{code:output1-start}-\ref{code:output2-end}. Then, $P.O \subset U_{i+1}$ holds. In summary, $P.O$ does not pruned by simplification, monotonicity and forward closure, therefore $P$ must be returned by SPARE.
%Next, observe that at each iteration $i$, candidates with size $i+2$ are generated. Then, $P.O$'s subset with size $i+2$ are always included in the candidate set at iteration $i$. This indicates that $O' \subset U$, thus any $O'$  would not be pruned by forward closure checking. Since none of the pruning operations removed $O'$, $P$ can be returned by SPARE.
%
%\begin{theorem}[Forward Closure Checking]
%\label{THM:SPM_FCC}
%Let $Lv_i$ be the candidates generated at level $i$ in Algorithm~\ref{algo:apriori_mining},
%if $FC_i$ is a proper pattern, then it is safe to terminate Algorithm~\ref{algo:apriori_mining}
%and directly output $FC_i$.
%\end{theorem}

%
%If $P$ is a valid pattern in original trajectories, 
%let $s$ be the object with smallest ID in $P.O$. 
%Based on the definition of GCMP, $\forall t \in P.T$, $\forall o \in P.O$, $C_t(s) = C_t(o)$.
%It follows that all object $o \in P.O$ are in $Sr_s$. 
%Furthermore, every timestamp in $P.T$ is included
%in $Sr_s$. Therefore, $P$ is a valid pattern in $Sr_s$. This ensures the \emph{completeness}. For any pattern $P$ enumerated by SPARE, by definition of star partition, $\forall o_1, o_2 \in P.O$, $\forall t \in P.T$, $C_t(o_1) = C_t(o_2)$. This ensure the \emph{soundness}.
\end{proof}

%\subsection{Proof of Theorem~\ref{THM:SPM_FCC}}
%\begin{proof}
%We prove by contradiction. Suppose there exists another pattern $P$ such that $P.O \neq FC_i$, 
%let $X=P.O - FC_i \neq \emptyset$. Consider a subset $P_1$ of $P$ which contains $X$ with size $i+1$, 
%(i.e., $P_1 \subseteq P, P_1\subseteq X, |P_1|=i+1$). Since $P$ is a proper pattern, 
%then $P_1$ is also a proper pattern. Therefore $P_1 \in Lv_i$.
%It follows $X$ is in the forward closure of $FC_i$, (i.e.,$X \in FC_i$), which contradicts with $X\notin FC_i$.
%\end{proof}